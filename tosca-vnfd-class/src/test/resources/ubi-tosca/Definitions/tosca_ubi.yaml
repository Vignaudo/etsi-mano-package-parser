tosca_definitions_version: tosca_simple_yaml_1_0
description: >
  Sample VNF for integration testing.

imports:
  - etsi_nfv_sol001_vnfd_types.yaml

topology_template:
  node_templates:
    ubiVdo.1_0:
      type: tosca.nodes.nfv.VNF
      properties:
        descriptor_id: dcd11fbf-c767-41eb-abc9-cec35dd95bca
        provider: Ubiqube internal.
        product_name: Integration tests
        software_version: 1.0.0
        descriptor_version: 1.0.0
        flavour_id: m1.small
      requirements:
        - virtual_link: vl01

    ext01:
      type: tosca.nodes.nfv.VnfExtCp
      properties:
        virtual_network_interface_requirements:
          - name: vl01
            description: descr
            support_mandatory: false
            network_interface_requirements: # map
            nic_io_requirements:
              logical_node_requirements: #map
      requirements:
        - external_virtual_link:
        - internal_virtual_link:

    leftVdu01:
      type: tosca.nodes.nfv.Vdu.Compute
      name: Left instance
      description: A node.
      properties:
        sw_image_data:
          name: cirros
          version: 1.0.0
          checksum:
            hash: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
            algorithm: SHA-256
          container_format: BARE
          disk_format: QCOW2
          min_disk: 6 GB
          min_ram: 2 GB
          operating_system: centos8
        monitoring_parameters:
          - name: metric name
            performance_metric: v_cpu_usage_mean_vnf
      capabilities:
        virtual_compute:
          properties:
            virtual_memory:
              properties:
                virtual_mem_size: 2 GB
            virtual_cpu:
              properties:
                cpu_architecture: x86_64
                num_virtual_cpu: 1


    rightVdu01:
      type: tosca.nodes.nfv.Vdu.Compute
      name: Right instance
      description: A node.
      properties:
        sw_image_data:
          name: cirros
          version: 1.0.0
          checksum:
            hash: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
            algorithm: SHA-256
          container_format: BARE
          disk_format: QCOW2
          min_disk: 6 GB
          min_ram: 2 GB
          operating_system: centos8
      capabilities:
        virtual_compute:
          properties:
            virtual_memory:
              properties:
                virtual_mem_size: 2 GB
            virtual_cpu:
              properties:
                cpu_architecture: x86_64
                num_virtual_cpu: 1

    block01:
      type: tosca.nodes.nfv.Vdu.VirtualBlockStorage
      properties:
        virtual_block_storage_data:
          size_of_storage: 6 GB
        sw_image_data:
          name: cirros
          version: 1.0.0
          checksum:
            hash: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
            algorithm: SHA-256
          container_format: BARE
          disk_format: QCOW2
          min_disk: 6 GB
          min_ram: 2 GB
          operating_system: centos8

    storageVo:
      type: tosca.nodes.nfv.Vdu.VirtualObjectStorage
      properties:
        virtual_object_storage_data:
          max_size_of_storage: 6 GB

    leftVl01:
      type: tosca.nodes.nfv.VnfVirtualLink
      properties:
        connectivity_type:
          layer_protocols:
            - ipv4
          flow_pattern: line
        description: Description of VL 01
        test_access:
          - passive_monitoring
        monitoring_parameters:
          - name: Vcpu Peak Usage
            collection_period: 60 s
            performance_metric: v_cpu_usage_mean_vnf
        vl_profile:
          max_bitrate_requirements:
            root: 10
            leaf: 15
          min_bitrate_requirements:
            root: 11
            leaf: 16
          virtual_link_protocol_data:
            - l2_protocol_data:
                name:
                vlan_transparent: true
                network_type: ntype
                mtu: 1500
              l3_protocol_data:
                dhcp_enabled: true
                cidr: 
                gateway_ip:
                ip_allocation_pools:
                  - start_ip_address: 192.168.0.100
                    end_ip_address: 192.168.0.254
              associated_layer_protocol: ipv4
              
          qos:
            latency: 5 ms
            packet_delay_variation: 1 s
            packet_loss_ratio: 0.01
      requirements:
        - virtual_storage: block01

    middleVl01:
      type: tosca.nodes.nfv.VnfVirtualLink
      properties:
        connectivity_type:
          layer_protocols: 
            - ipv4
          flow_pattern: line
        description: Description of MiddleVL 01
        vl_profile:
          max_bitrate_requirements:
            root: 10
            leaf: 15
          min_bitrate_requirements:
            root: 11
            leaf: 16
          virtual_link_protocol_data:
          qos:
            latency: 5 ms
            packet_delay_variation: 1 s
            packet_loss_ratio: 0.01


    rightVl01:
      type: tosca.nodes.nfv.VnfVirtualLink
      properties:
        connectivity_type:
          layer_protocols: 
            - ipv4
          flow_pattern: line
        description: Right of VL 01
        vl_profile:
          max_bitrate_requirements:
            root: 10
            leaf: 15
          min_bitrate_requirements:
            root: 11
            leaf: 16
          virtual_link_protocol_data:
          qos:
            latency: 5 ms
            packet_delay_variation: 1 s
            packet_loss_ratio: 0.01

    cpLc01:
      type: tosca.nodes.nfv.VduCp
      properties:
        bitrate_requirement: 5
        virtual_network_interface_requirements:
          - name: vl01
            description: descr
            support_mandatory: false
            network_interface_requirements: # map
            nic_io_requirements:
              logical_node_requirements: #map
        order: 5
        vnic_type: virtio
      requirements:
        - virtual_link:
            node: leftVl01
        - virtual_binding:
            node: leftVdu01

    cpLc02:
      type: tosca.nodes.nfv.VduCp
      properties:
        bitrate_requirement: 5
        order: 5
        vnic_type: virtio
      requirements:
        - virtual_link:
            node: middleVl01
        - virtual_binding:
            node: leftVdu01


    cpRc01:
      type: tosca.nodes.nfv.VduCp
      properties:
        bitrate_requirement: 5
        order: 5
        vnic_type: virtio
      requirements:
        - virtual_link:
            node: rightVl01
        - virtual_binding:
            node: rightVdu01

    cpRc02:
      type: tosca.nodes.nfv.VduCp
      properties:
        bitrate_requirement: 5
        order: 5
        vnic_type: virtio
      requirements:
        - virtual_link:
            node: middleVl01
        - virtual_binding:
            node: rightVdu01
